import pandas as pd


def e010_version_features(df):
    '''
    cce の nan 以外を valid として train test の整合性をとっても良いかも

    '''
    # set them as numerical
    df.set_index('MachineIdentifier', inplace=True)
    df = df.astype(int)
    df.reset_index('MachineIdentifier', inplace=True)

    res_df = pd.DataFrame()
    res_df['MachineIdentifier'] = df['MachineIdentifier']

    # horizontal multiplication
    res_df['Engine2_App1'] = df['e003_EngineVersion_2'] * df['e003_AppVersion_1']
    res_df['Engine2_App2'] = df['e003_EngineVersion_2'] * df['e003_AppVersion_2']
    res_df['Engine2_App3'] = df['e003_EngineVersion_2'] * df['e003_AppVersion_3']
    res_df['Engine2_App3'] = df['e003_EngineVersion_2'] * df['e003_AppVersion_3']
    res_df['Engine2_CenOs0'] = df['e003_EngineVersion_2'] * df['e003_Census_OSVersion_0']
    res_df['Engine2_CenOs1'] = df['e003_EngineVersion_2'] * df['e003_Census_OSVersion_1']
    res_df['Engine2_CenOs2'] = df['e003_EngineVersion_2'] * df['e003_Census_OSVersion_2']
    res_df['Engine2_CenOs3'] = df['e003_EngineVersion_2'] * df['e003_Census_OSVersion_3']
    res_df['Engine2_OsBuild0'] = df['e003_EngineVersion_2'] * df['e003_OsBuildLab_0']
    res_df['Engine2_OsBuild1'] = df['e003_EngineVersion_2'] * df['e003_OsBuildLab_1']
    res_df['Engine2_Os0'] = df['e003_EngineVersion_2'] * df['e009_OsVer_0']
    res_df['Engine2_Os1'] = df['e003_EngineVersion_2'] * df['e009_OsVer_1']
    res_df['Engine2_Os2'] = df['e003_EngineVersion_2'] * df['e009_OsVer_2']
    res_df['Engine2_Os3'] = df['e003_EngineVersion_2'] * df['e009_OsVer_3']
    res_df['Engine3_App1'] = df['e003_EngineVersion_3'] * df['e003_AppVersion_1']
    res_df['Engine3_App2'] = df['e003_EngineVersion_3'] * df['e003_AppVersion_2']
    res_df['Engine3_App3'] = df['e003_EngineVersion_3'] * df['e003_AppVersion_3']
    res_df['Engine3_App3'] = df['e003_EngineVersion_3'] * df['e003_AppVersion_3']
    res_df['Engine3_CenOs0'] = df['e003_EngineVersion_3'] * df['e003_Census_OSVersion_0']
    res_df['Engine3_CenOs1'] = df['e003_EngineVersion_3'] * df['e003_Census_OSVersion_1']
    res_df['Engine3_CenOs2'] = df['e003_EngineVersion_3'] * df['e003_Census_OSVersion_2']
    res_df['Engine3_CenOs3'] = df['e003_EngineVersion_3'] * df['e003_Census_OSVersion_3']
    res_df['Engine3_OsBuild0'] = df['e003_EngineVersion_3'] * df['e003_OsBuildLab_0']
    res_df['Engine3_OsBuild1'] = df['e003_EngineVersion_3'] * df['e003_OsBuildLab_1']
    res_df['Engine3_Os0'] = df['e003_EngineVersion_3'] * df['e009_OsVer_0']
    res_df['Engine3_Os1'] = df['e003_EngineVersion_3'] * df['e009_OsVer_1']
    res_df['Engine3_Os2'] = df['e003_EngineVersion_3'] * df['e009_OsVer_2']
    res_df['Engine3_Os3'] = df['e003_EngineVersion_3'] * df['e009_OsVer_3']
    res_df['App1_CenOs0'] = df['e003_AppVersion_1'] * df['e003_Census_OSVersion_0']
    res_df['App1_CenOs1'] = df['e003_AppVersion_1'] * df['e003_Census_OSVersion_1']
    res_df['App1_CenOs2'] = df['e003_AppVersion_1'] * df['e003_Census_OSVersion_2']
    res_df['App1_CenOs3'] = df['e003_AppVersion_1'] * df['e003_Census_OSVersion_3']
    res_df['App1_OsBuild0'] = df['e003_AppVersion_1'] * df['e003_OsBuildLab_0']
    res_df['App1_OsBuild1'] = df['e003_AppVersion_1'] * df['e003_OsBuildLab_1']
    res_df['App1_Os0'] = df['e003_AppVersion_1'] * df['e009_OsVer_0']
    res_df['App1_Os1'] = df['e003_AppVersion_1'] * df['e009_OsVer_1']
    res_df['App1_Os2'] = df['e003_AppVersion_1'] * df['e009_OsVer_2']
    res_df['App1_Os3'] = df['e003_AppVersion_1'] * df['e009_OsVer_3']
    res_df['App2_CenOs0'] = df['e003_AppVersion_2'] * df['e003_Census_OSVersion_0']
    res_df['App2_CenOs1'] = df['e003_AppVersion_2'] * df['e003_Census_OSVersion_1']
    res_df['App2_CenOs2'] = df['e003_AppVersion_2'] * df['e003_Census_OSVersion_2']
    res_df['App2_CenOs3'] = df['e003_AppVersion_2'] * df['e003_Census_OSVersion_3']
    res_df['App2_OsBuild0'] = df['e003_AppVersion_2'] * df['e003_OsBuildLab_0']
    res_df['App2_OsBuild1'] = df['e003_AppVersion_2'] * df['e003_OsBuildLab_1']
    res_df['App2_Os0'] = df['e003_AppVersion_2'] * df['e009_OsVer_0']
    res_df['App2_Os1'] = df['e003_AppVersion_2'] * df['e009_OsVer_1']
    res_df['App2_Os2'] = df['e003_AppVersion_2'] * df['e009_OsVer_2']
    res_df['App2_Os3'] = df['e003_AppVersion_2'] * df['e009_OsVer_3']
    res_df['App3_CenOs0'] = df['e003_AppVersion_3'] * df['e003_Census_OSVersion_0']
    res_df['App3_CenOs1'] = df['e003_AppVersion_3'] * df['e003_Census_OSVersion_1']
    res_df['App3_CenOs2'] = df['e003_AppVersion_3'] * df['e003_Census_OSVersion_2']
    res_df['App3_CenOs3'] = df['e003_AppVersion_3'] * df['e003_Census_OSVersion_3']
    res_df['App3_OsBuild0'] = df['e003_AppVersion_3'] * df['e003_OsBuildLab_0']
    res_df['App3_OsBuild1'] = df['e003_AppVersion_3'] * df['e003_OsBuildLab_1']
    res_df['App3_Os0'] = df['e003_AppVersion_3'] * df['e009_OsVer_0']
    res_df['App3_Os1'] = df['e003_AppVersion_3'] * df['e009_OsVer_1']
    res_df['App3_Os2'] = df['e003_AppVersion_3'] * df['e009_OsVer_2']
    res_df['App3_Os3'] = df['e003_AppVersion_3'] * df['e009_OsVer_3']
    res_df['CenOs0_OsBuild0'] = df['e003_Census_OSVersion_0'] * df['e003_OsBuildLab_0']
    res_df['CenOs0_OsBuild1'] = df['e003_Census_OSVersion_0'] * df['e003_OsBuildLab_1']
    res_df['CenOs0_OsVer0'] = df['e003_Census_OSVersion_0'] * df['e009_OsVer_0']
    res_df['CenOs0_OsVer1'] = df['e003_Census_OSVersion_0'] * df['e009_OsVer_1']
    res_df['CenOs0_OsVer2'] = df['e003_Census_OSVersion_0'] * df['e009_OsVer_2']
    res_df['CenOs0_OsVer3'] = df['e003_Census_OSVersion_0'] * df['e009_OsVer_3']
    res_df['CenOs1_OsBuild0'] = df['e003_Census_OSVersion_1'] * df['e003_OsBuildLab_0']
    res_df['CenOs1_OsBuild1'] = df['e003_Census_OSVersion_1'] * df['e003_OsBuildLab_1']
    res_df['CenOs1_OsVer0'] = df['e003_Census_OSVersion_1'] * df['e009_OsVer_0']
    res_df['CenOs1_OsVer1'] = df['e003_Census_OSVersion_1'] * df['e009_OsVer_1']
    res_df['CenOs1_OsVer2'] = df['e003_Census_OSVersion_1'] * df['e009_OsVer_2']
    res_df['CenOs1_OsVer3'] = df['e003_Census_OSVersion_1'] * df['e009_OsVer_3']
    res_df['CenOs2_OsBuild0'] = df['e003_Census_OSVersion_2'] * df['e003_OsBuildLab_0']
    res_df['CenOs2_OsBuild1'] = df['e003_Census_OSVersion_2'] * df['e003_OsBuildLab_1']
    res_df['CenOs2_OsVer0'] = df['e003_Census_OSVersion_2'] * df['e009_OsVer_0']
    res_df['CenOs2_OsVer1'] = df['e003_Census_OSVersion_2'] * df['e009_OsVer_1']
    res_df['CenOs2_OsVer2'] = df['e003_Census_OSVersion_2'] * df['e009_OsVer_2']
    res_df['CenOs2_OsVer3'] = df['e003_Census_OSVersion_2'] * df['e009_OsVer_3']
    res_df['CenOs3_OsBuild0'] = df['e003_Census_OSVersion_3'] * df['e003_OsBuildLab_0']
    res_df['CenOs3_OsBuild1'] = df['e003_Census_OSVersion_3'] * df['e003_OsBuildLab_1']
    res_df['CenOs3_OsVer0'] = df['e003_Census_OSVersion_3'] * df['e009_OsVer_0']
    res_df['CenOs3_OsVer1'] = df['e003_Census_OSVersion_3'] * df['e009_OsVer_1']
    res_df['CenOs3_OsVer2'] = df['e003_Census_OSVersion_3'] * df['e009_OsVer_2']
    res_df['CenOs3_OsVer3'] = df['e003_Census_OSVersion_3'] * df['e009_OsVer_3']
    res_df['OsBuild0_OsVer0'] = df['e003_OsBuildLab_0'] * df['e009_OsVer_0']
    res_df['OsBuild0_OsVer1'] = df['e003_OsBuildLab_0'] * df['e009_OsVer_1']
    res_df['OsBuild0_OsVer2'] = df['e003_OsBuildLab_0'] * df['e009_OsVer_2']
    res_df['OsBuild0_OsVer3'] = df['e003_OsBuildLab_0'] * df['e009_OsVer_3']
    res_df['OsBuild1_OsVer0'] = df['e003_OsBuildLab_1'] * df['e009_OsVer_0']
    res_df['OsBuild1_OsVer1'] = df['e003_OsBuildLab_1'] * df['e009_OsVer_1']
    res_df['OsBuild1_OsVer2'] = df['e003_OsBuildLab_1'] * df['e009_OsVer_2']
    res_df['OsBuild1_OsVer3'] = df['e003_OsBuildLab_1'] * df['e009_OsVer_3']

    # ver multiple in the OsBuildLab
    res_df['e003_ObBuildLab_0_times_3'] = df['e003_OsBuildLab_0'] * df['e003_OsBuildLab_1']

    # bool ver feature
    res_df['Census_OSBuildNumber_match'] = (df['Census_OSBuildNumber'] == df['e003_OsBuildLab_0']).astype(int)

    # add exp id to the col
    res_df.columns = ['e010_' + col if col !=
                      'MachineIdentifier' else col for col in res_df.columns]
    return res_df
