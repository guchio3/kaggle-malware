import numpy as np
import pandas as pd


class TimeSplitSingleFold():
    def __init__(self, shuffle=True, random_state=71):
        self.shuffle = shuffle
        np.random.seed(random_state)

    def split(self, val_flgs):
        val_flgs = val_flgs['val_flg']
        indices = np.arange(len(val_flgs))
        for i in range(1):
            train = indices[val_flgs == i]
            valid = indices[val_flgs != i]
            if self.shuffle:
                train = np.random.permutation(train)
            yield train, valid
