import pandas as pd


def e011_new_numerical_features(df):
    res_df = pd.DataFrame()
    res_df['MachineIdentifier'] = df['MachineIdentifier']

    # ram features
    res_df['ram_per_disk'] = df['Census_TotalPhysicalRAM'] / \
        df['Census_SystemVolumeTotalCapacity']
    res_df['ram_per_primary_disk'] = df['Census_TotalPhysicalRAM'] / \
        df['Census_PrimaryDiskTotalCapacity']
    res_df['ram_per_non_primary_disk'] = df['Census_TotalPhysicalRAM'] / \
        df['e003_non_primary_drive_MB']

    # cpu features
    res_df['cpu_per_disk'] = df['Census_ProcessorCoreCount'] / \
        df['Census_SystemVolumeTotalCapacity']
    res_df['cpu_per_primary_disk'] = df['Census_ProcessorCoreCount'] / \
        df['Census_PrimaryDiskTotalCapacity']
    res_df['cpu_per_non_primary_disk'] = df['Census_ProcessorCoreCount'] / \
        df['e003_non_primary_drive_MB']

    # battery features
    res_df['battery_per_cpu'] = df['Census_InternalBatteryNumberOfCharges'] / \
        df['Census_ProcessorCoreCount']
    res_df['battery_per_ram'] = df['Census_InternalBatteryNumberOfCharges'] / \
        df['Census_TotalPhysicalRAM']
    res_df['battery_per_disk'] = df['Census_InternalBatteryNumberOfCharges'] / \
        df['Census_SystemVolumeTotalCapacity']
    res_df['battery_per_primary_disk'] = df['Census_InternalBatteryNumberOfCharges'] / \
        df['Census_PrimaryDiskTotalCapacity']
    res_df['battery_per_non_primary_disk'] = df['Census_InternalBatteryNumberOfCharges'] / \
        df['e003_non_primary_drive_MB']
    res_df['new_num_2'] = df['Census_InternalBatteryNumberOfCharges'] / \
        (df['Census_TotalPhysicalRAM'] * df['Census_ProcessorCoreCount'])

    # add exp id to the col
    res_df.columns = ['e011_' + col if col !=
                      'MachineIdentifier' else col for col in res_df.columns]
    return res_df
